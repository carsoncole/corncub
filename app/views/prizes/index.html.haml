.row
  .col-md-12
    %h2 Prizes
    %p= link_to "Prize Cart", prize_cart_path(current_scout.prize_cart(@active_event))

%br

- Prize::SOURCES.each do |source|

  - prizes = @active_event.prizes.where(source: source).order(sales_amount: :asc)
  - if prizes.any?
    .row
      .col-md-12
        %h4
          = source
          Prizes

    .row

      .col-md-3
        .card
          .card-block.card-text.text-center
            %p
              Your remaining sales credits that can be applied towards
              = source
              prizes:
            %h3
              %span.badge.badge-success{class: "#{source.parameterize} remaining-sales-credits" }
                = number_to_currency(current_scout.prize_cart(@active_event).sales_credits_available(source))


      .col-md-3
        .card
          .card-block.card-text.text-center
            %p
              Sales value of
              = source
              prizes in your cart:
            %h3
              %span.badge.badge-success{class: "#{source.parameterize} used-credits" }
                = number_to_currency(@current_scout.prize_cart(@active_event).sales_credits_used(source))

    %br


    .row
      - prizes.each do |prize|
        .col-md-3
          .card.text-center
            .card-header
              %h5.card-text= prize.name
              %p.card-text
                = link_to prize_path(prize) do
                  %i.fa.fa-pencil
            .card-block
              - if prize.description.present?
                %p.card-text= prize.description

              %p.card-text
                - unless prize.reduces_sales_credits
                  Achieve sales of:
                  %br
                = number_to_currency(prize.sales_amount)

            - if prize.reduces_sales_credits && current_scout.prize_cart(@active_event).sales_credits_available(source) >= prize.sales_amount
              .card-footer
                = button_to "Add to Cart", prize_cart_order_path(prize_id: prize.id) , class: "btn btn-primary btn-sm #{prize.name.parameterize}"


    %br

.row
  .col-md-12
    .card.small
      .card-block
        .card-title
          %h2 Inventory Ledger
        - if current_scout.is_admin?
          %p
            = link_to stock_movement_path do
              %i.fa.fa-print.fa-lg
              Stock Movement
            %span
              = link_to new_stock_path, class: 'hidden-print' do
                &nbsp;
                %i.fa.fa-plus.fa-lg

        %ul.nav.nav-tabs.hidden-print
          %li.nav-item
            = link_to "All", stocks_path, class: "nav-link #{!params[:location] ? 'active' : nil}"          
          - @locations.each do |location|
            %li.nav-item
              = link_to location.location.titleize, stocks_ledger_path(location: location.location), class: "nav-link #{params[:location] == location.location ? 'active' : nil}"
        %br
        .table-responsive
          %table.table.table-sm
            %thead
              %tr
                %th Date
                %th Product
                %th Desc
                %th 
                %th Qty
                %th Location
                %th Created
                %th Created by
                %th From BSA
                %th
                %th

            %tbody
              - @stocks.each do |stock|
                %tr
                  %td= nice_date_compact(stock.date) if stock.date
                  %td= stock.product.name_with_id
                  %td= stock.description
                  %td
                    - if stock.take_order_id
                      = link_to "Take Order", take_order_path(stock.take_order_id)
                    - elsif stock.direct_sale_id
                      = link_to "Direct Sale", direct_sale_path(stock.site_sale_id)
                    - elsif stock.site_sale_id
                      = link_to "Site Sale", site_sale_path(stock.site_sale_id)
                  %td= stock.quantity
                  %td= stock.location.titleize if stock.location
                  %td= nice_date_time_less(stock.created_at)
                  %td
                    - if stock.created_by == 999
                      System
                    - elsif stock.created_by.blank?
                      =""
                    - else
                      = Scout.find(stock.created_by).name
                  %td
                    - if stock.is_transfer_from_bsa
                      %i.fa.fa-check
                  %td
                    = link_to edit_stock_path(stock) do
                      %i.fa.fa-pencil.fa-lg
                  %td
                    = link_to stock_path(stock), method: :delete do
                      %i.fa.fa-trash.fa-lg

              %tr
                %td                
                  = link_to new_stock_path do
                    %i.fa.fa-plus.fa-lg
                %td
                %td
                %td
                %td
                %td
        = paginate @stocks
